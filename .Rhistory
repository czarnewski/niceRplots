XX <- (X == i)*1
rows <- rows * sum(attr(EI,"H"))
cols <- cols * sum(attr(EI,"W"))
attr(EI,"W") <- attr(EI,"W") * (cols[colSums(XX)>0] / sum(attr(EI,"W")))
attr(EI,"H") <- attr(EI,"H") * (rows[rowSums(XX)>0] / sum(attr(EI,"H")))
EI <- LM( EI ,R = nrow(EI) ,W = attr(EI,"W"),H = attr(EI,"H"))
EI <- ELM(EI)
# rows[rowSums(XX)>0] <- rows[rowSums(XX)>0] * sum(attr(EI,"H"))
# cols[colSums(XX)>0] <- cols[colSums(XX)>0] * sum(attr(EI,"W"))
# Expand rows
tmp <- rep(1:nrow(X),rows)
X <- X[tmp,]
# Expand columns
tmp <- rep(1:ncol(X),cols)
X <- X[,tmp]
oi <- unique(c(t(get(i))))
oi <- setNames(1:length(oi),oi)
ff <- grep(i,names(o))
oi <- oi + (ff-1)
sel <- (o > ff) & (grepl('[0-9]',names(o)))
if( sum(sel)>0 ){
nn <- as.numeric( factor(names(o)[sel]) )
nn <- nn + max(oi)
o[sel] <- nn
}
o <- unique(c(t(X)))
o <- setNames(1:length(o),o)
Ns <- as.numeric(grep("[0-9]",names(o),value = T))
EI <- ELM(get(i))
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
XX <- (X == i)*1
rowsX <- rows * sum(attr(EI,"H"))
colsX <- cols * sum(attr(EI,"W"))
attr(EI,"W") <- attr(EI,"W") * (colsX[colSums(XX)>0] / sum(attr(EI,"W")))
attr(EI,"H") <- attr(EI,"H") * (rowsX[rowSums(XX)>0] / sum(attr(EI,"H")))
EI <- LM( EI ,R = nrow(EI) ,W = attr(EI,"W"),H = attr(EI,"H"))
EI <- ELM(EI)
# rows[rowSums(XX)>0] <- rows[rowSums(XX)>0] * sum(attr(EI,"H"))
# cols[colSums(XX)>0] <- cols[colSums(XX)>0] * sum(attr(EI,"W"))
# Expand rows
tmp <- rep(1:nrow(X),rows)
X <- X[tmp,]
B <- LM( X=c(1,"A",10,11) , C=2 , W=c(.5,1) , H=c(1,1) )
B
X <- B
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
o <- unique(c(t(X)))
o <- setNames(1:length(o),o)
Ns <- as.numeric(grep("[0-9]",names(o),value = T))
EI <- ELM(get(i))
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
XX <- (X == i)*1
rowsX <- rows * sum(attr(EI,"H"))
colsX <- cols * sum(attr(EI,"W"))
attr(EI,"W") <- attr(EI,"W") * (colsX[colSums(XX)>0] / sum(attr(EI,"W")))
attr(EI,"H") <- attr(EI,"H") * (rowsX[rowSums(XX)>0] / sum(attr(EI,"H")))
EI <- LM( EI ,R = nrow(EI) ,W = attr(EI,"W"),H = attr(EI,"H"))
EI <- ELM(EI)
# Expand rows
tmp <- rep(1:nrow(X),rows)
X <- X[tmp,]
# Expand columns
tmp <- rep(1:ncol(X),cols)
X <- X[,tmp]
oi <- unique(c(t(get(i))))
oi <- setNames(1:length(oi),oi)
ff <- grep(i,names(o))
oi <- oi + (ff-1)
sel <- (o > ff) & (grepl('[0-9]',names(o)))
if( sum(sel)>0 ){
nn <- as.numeric( factor(names(o)[sel]) )
nn <- nn + max(oi)
o[sel] <- nn
}
o[i] <- i
o
for(j in 1:length(o)){
X[X==names(o)[j]] <- o[j]
}
X
B <- LM( X=c(1,"A",10,11) , C=2 , W=c(.5,1) , H=c(1,1) )
B
X <- B
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
o <- unique(c(t(X)))
o <- setNames(1:length(o),o)
Ns <- as.numeric(grep("[0-9]",names(o),value = T))
EI <- ELM(get(i))
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
XX <- (X == i)*1
rows <- rows * sum(attr(EI,"H"))
cols <- cols * sum(attr(EI,"W"))
attr(EI,"W") <- attr(EI,"W") * (cols[colSums(XX)>0] / sum(attr(EI,"W")))
attr(EI,"H") <- attr(EI,"H") * (rows[rowSums(XX)>0] / sum(attr(EI,"H")))
EI <- LM( EI ,R = nrow(EI) ,W = attr(EI,"W"),H = attr(EI,"H"))
EI <- ELM(EI)
# rows[rowSums(XX)>0] <- rows[rowSums(XX)>0] * sum(attr(EI,"H"))
# cols[colSums(XX)>0] <- cols[colSums(XX)>0] * sum(attr(EI,"W"))
# Expand rows
tmp <- rep(1:nrow(X),rows)
X <- X[tmp,]
# Expand columns
tmp <- rep(1:ncol(X),cols)
X <- X[,tmp]
oi <- unique(c(t(get(i))))
oi <- setNames(1:length(oi),oi)
ff <- grep(i,names(o))
oi <- oi + (ff-1)
sel <- (o > ff) & (grepl('[0-9]',names(o)))
if( sum(sel)>0 ){
nn <- as.numeric( factor(names(o)[sel]) )
nn <- nn + max(oi)
o[sel] <- nn
}
o[i] <- i
X
X == names(o)[j]
1:length(o)
o[j]
j="A"
X == j
o[j]
X[X == j]
o[j]
for(j in names(o)){
X[X == j] <- o[j]
}
X
EI
oi
ff
for(j in names(oi)){
EI[EI == j] <- oi[j]
}
EI
names(oi)
EI
j
oi[j]
B <- LM( X=c(1,"A",10,11) , C=2 , W=c(.5,1) , H=c(1,1) )
B
X <- B
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
sel <- !grepl("[0-9]",X)
o <- unique(c(t(X)))
o <- setNames(1:length(o),o)
Ns <- as.numeric(grep("[0-9]",names(o),value = T))
EI <- ELM(get(i))
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
XX <- (X == i)*1
rows <- rows * sum(attr(EI,"H"))
cols <- cols * sum(attr(EI,"W"))
attr(EI,"W") <- attr(EI,"W") * (cols[colSums(XX)>0] / sum(attr(EI,"W")))
attr(EI,"H") <- attr(EI,"H") * (rows[rowSums(XX)>0] / sum(attr(EI,"H")))
EI <- LM( EI ,R = nrow(EI) ,W = attr(EI,"W"),H = attr(EI,"H"))
EI <- ELM(EI)
# rows[rowSums(XX)>0] <- rows[rowSums(XX)>0] * sum(attr(EI,"H"))
# cols[colSums(XX)>0] <- cols[colSums(XX)>0] * sum(attr(EI,"W"))
# Expand rows
tmp <- rep(1:nrow(X),rows)
X <- X[tmp,]
# Expand columns
tmp <- rep(1:ncol(X),cols)
X <- X[,tmp]
oi <- unique(c(t(get(i))))
oi <- setNames(1:length(oi),oi)
ff <- grep(i,names(o))
oi <- oi + (ff-1)
sel <- (o > ff) & (grepl('[0-9]',names(o)))
if( sum(sel)>0 ){
nn <- as.numeric( factor(names(o)[sel]) )
nn <- nn + max(oi)
o[sel] <- nn
}
o[i] <- i
X
for(j in rev(names(o)) ){
X[X == j] <- o[j]
}
for(j in rev(names(oi)) ){
EI[EI == j] <- oi[j]
}
EI
X
X[X==i] <- EI
X
B <- LM( X=c(1,"A",10,11) , C=2 , W=c(.5,1) , H=c(1,1) )
B
X <- B
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
sel <- !grepl("[0-9]",X)
o <- unique(c(t(X)))
o <- setNames(1:length(o),o)
Ns <- as.numeric(grep("[0-9]",names(o),value = T))
EI <- ELM(get(i))
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
XX <- (X == i)*1
rows <- rows * sum(attr(EI,"H"))
cols <- cols * sum(attr(EI,"W"))
attr(EI,"W") <- attr(EI,"W") * (cols[colSums(XX)>0] / sum(attr(EI,"W")))
attr(EI,"H") <- attr(EI,"H") * (rows[rowSums(XX)>0] / sum(attr(EI,"H")))
EI <- LM( EI ,R = nrow(EI) ,W = attr(EI,"W"),H = attr(EI,"H"))
EI <- ELM(EI)
# rows[rowSums(XX)>0] <- rows[rowSums(XX)>0] * sum(attr(EI,"H"))
# cols[colSums(XX)>0] <- cols[colSums(XX)>0] * sum(attr(EI,"W"))
# Expand rows
tmp <- rep(1:nrow(X),rows)
X <- X[tmp,]
# Expand columns
tmp <- rep(1:ncol(X),cols)
X <- X[,tmp]
oi <- unique(c(t(get(i))))
oi <- setNames(1:length(oi),oi)
ff <- grep(i,names(o))
oi <- oi + (ff-1)
sel <- (o > ff) & (grepl('[0-9]',names(o)))
if( sum(sel)>0 ){
nn <- as.numeric( factor(names(o)[sel]) )
nn <- nn + max(oi)
o[sel] <- nn
}
o[i] <- i
X
for(j in rev(names(o)) ){
X[X == j] <- o[j]
}
for(j in rev(names(oi)) ){
EI[EI == j] <- oi[j]
}
EI
t(EI)
X[X==i] <- t(EI)
X
EI
B <- LM( X=c(1,"A",10,11) , C=2 , W=c(.5,1) , H=c(1,1) )
B
X <- B
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
sel <- !grepl("[0-9]",X)
o <- unique(c(t(X)))
o <- setNames(1:length(o),o)
Ns <- as.numeric(grep("[0-9]",names(o),value = T))
EI <- ELM(get(i))
EI
o <- unique(c(t(X)))
o <- setNames(1:length(o),o)
Ns <- as.numeric(grep("[0-9]",names(o),value = T))
EI <- ELM(get(i))
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
XX <- (X == i)*1
rows <- rows * sum(attr(EI,"H"))
cols <- cols * sum(attr(EI,"W"))
attr(EI,"W") <- attr(EI,"W") * (cols[colSums(XX)>0] / sum(attr(EI,"W")))
attr(EI,"H") <- attr(EI,"H") * (rows[rowSums(XX)>0] / sum(attr(EI,"H")))
EI <- LM( EI ,R = nrow(EI) ,W = attr(EI,"W"),H = attr(EI,"H"))
EI <- ELM(EI)
# rows[rowSums(XX)>0] <- rows[rowSums(XX)>0] * sum(attr(EI,"H"))
# cols[colSums(XX)>0] <- cols[colSums(XX)>0] * sum(attr(EI,"W"))
# Expand rows
tmp <- rep(1:nrow(X),rows)
X <- X[tmp,]
# Expand columns
tmp <- rep(1:ncol(X),cols)
X <- X[,tmp]
oi <- unique(c(t(get(i))))
oi <- setNames(1:length(oi),oi)
ff <- grep(i,names(o))
oi <- oi + (ff-1)
sel <- (o > ff) & (grepl('[0-9]',names(o)))
if( sum(sel)>0 ){
nn <- as.numeric( factor(names(o)[sel]) )
nn <- nn + max(oi)
o[sel] <- nn
}
o[i] <- i
X
for(j in rev(names(o)) ){
X[X == j] <- o[j]
}
for(j in rev(names(oi)) ){
EI[EI == j] <- oi[j]
}
X[X==i] <- EI
X
B <- LM( X=c(1,"A",10,11) , C=2 , W=c(.5,1) , H=c(1,1) )
B
X <- B
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
sel <- !grepl("[0-9]",X)
o <- unique(c(t(X)))
o <- setNames(1:length(o),o)
Ns <- as.numeric(grep("[0-9]",names(o),value = T))
EI <- ELM(get(i))
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
XX <- (X == i)*1
rows <- rows * sum(attr(EI,"H"))
cols <- cols * sum(attr(EI,"W"))
attr(EI,"W") <- attr(EI,"W") * (cols[colSums(XX)>0] / sum(attr(EI,"W")))
attr(EI,"H") <- attr(EI,"H") * (rows[rowSums(XX)>0] / sum(attr(EI,"H")))
EI <- LM( EI ,R = nrow(EI) ,W = attr(EI,"W"),H = attr(EI,"H"))
EI <- ELM(EI)
# rows[rowSums(XX)>0] <- rows[rowSums(XX)>0] * sum(attr(EI,"H"))
# cols[colSums(XX)>0] <- cols[colSums(XX)>0] * sum(attr(EI,"W"))
# Expand rows
tmp <- rep(1:nrow(X),rows)
X <- X[tmp,]
# Expand columns
tmp <- rep(1:ncol(X),cols)
X <- X[,tmp]
oi <- unique(c(t(get(i))))
oi <- setNames(1:length(oi),oi)
ff <- grep(i,names(o))
oi <- oi + (ff-1)
sel <- (o > ff) & (grepl('[0-9]',names(o)))
if( sum(sel)>0 ){
nn <- as.numeric( factor(names(o)[sel]) )
nn <- nn + max(oi)
o[sel] <- nn
}
o[i] <- i
X
for(j in rev(names(o)) ){
X[X == j] <- o[j]
}
for(j in rev(names(oi)) ){
EI[EI == j] <- oi[j]
}
X[X==i] <- t(EI)
X
B <- LM( X=c(1,"A",10,11) , C=2 , W=c(.5,1) , H=c(1,1) )
B
X <- B
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
sel <- !grepl("[0-9]",X)
o <- unique(c(t(X)))
o <- setNames(1:length(o),o)
Ns <- as.numeric(grep("[0-9]",names(o),value = T))
EI <- ELM(get(i))
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
XX <- (X == i)*1
XX
rows
cols
XX
X[X==i]
rows <- rows * sum(attr(EI,"H"))
cols <- cols * sum(attr(EI,"W"))
attr(EI,"W") <- attr(EI,"W") * (cols[colSums(XX)>0] / sum(attr(EI,"W")))
attr(EI,"H") <- attr(EI,"H") * (rows[rowSums(XX)>0] / sum(attr(EI,"H")))
EI <- LM( EI ,R = nrow(EI) ,W = attr(EI,"W"),H = attr(EI,"H"))
EI <- ELM(EI)
# rows[rowSums(XX)>0] <- rows[rowSums(XX)>0] * sum(attr(EI,"H"))
# cols[colSums(XX)>0] <- cols[colSums(XX)>0] * sum(attr(EI,"W"))
# Expand rows
tmp <- rep(1:nrow(X),rows)
X <- X[tmp,]
# Expand columns
tmp <- rep(1:ncol(X),cols)
X <- X[,tmp]
oi <- unique(c(t(get(i))))
oi <- setNames(1:length(oi),oi)
ff <- grep(i,names(o))
oi <- oi + (ff-1)
sel <- (o > ff) & (grepl('[0-9]',names(o)))
if( sum(sel)>0 ){
nn <- as.numeric( factor(names(o)[sel]) )
nn <- nn + max(oi)
o[sel] <- nn
}
o[i] <- i
X
for(j in rev(names(o)) ){
X[X == j] <- o[j]
}
for(j in rev(names(oi)) ){
EI[EI == j] <- oi[j]
}
X[X==i]
X
t(EI)
EI
EI
B <- LM( X=c(1,"A",10,11) , C=2 , W=c(.5,1) , H=c(1,1) )
B
X <- B
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
o <- unique(c(t(X)))
o <- setNames(1:length(o),o)
Ns <- as.numeric(grep("[0-9]",names(o),value = T))
EI <- ELM(get(i))
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
XX <- (X == i)*1
rows <- rows * sum(attr(EI,"H"))
cols <- cols * sum(attr(EI,"W"))
attr(EI,"W") <- attr(EI,"W") * (cols[colSums(XX)>0] / sum(attr(EI,"W")))
attr(EI,"H") <- attr(EI,"H") * (rows[rowSums(XX)>0] / sum(attr(EI,"H")))
EI <- LM( EI ,R = nrow(EI) ,W = attr(EI,"W"),H = attr(EI,"H"))
EI <- ELM(EI)
EI
o <- unique(c(t(X)))
o <- setNames(1:length(o),o)
Ns <- as.numeric(grep("[0-9]",names(o),value = T))
EI <- ELM(get(i))
EI
rows <- round( (attr(X,"H"))/min(attr(X,"H")) )
cols <- round( (attr(X,"W"))/min(attr(X,"W")) )
XX <- (X == i)*1
XX
cols[colSums(XX)>0]
rows[rowSums(XX)>0]
X
attr(EI,"W")
attr(EI,"H")
attr(EI,"W") * (cols[colSums(XX)>0] / sum(attr(EI,"W")))
attr(EI,"H") * (rows[rowSums(XX)>0] / sum(attr(EI,"H")))
rows
cols
attr(EI,"W") * (cols[colSums(XX)>0] / min(attr(EI,"W")))
attr(EI,"H") * (rows[rowSums(XX)>0] / min(attr(EI,"H")))
attr(EI,"W") <- round(attr(EI,"W") * (cols[colSums(XX)>0] / min(attr(EI,"W"))))
attr(EI,"H") <- round(attr(EI,"H") * (rows[rowSums(XX)>0] / min(attr(EI,"H"))))
attr(EI,"W")
attr(EI,"H")
nrow(EI)
EI
EI <- LM( EI ,R = nrow(EI) ,W = attr(EI,"W"),H = attr(EI,"H"))
EI
ELM(EI)
ceiling( (1:20) / sum(1:20))
ceiling( (1:20) / min(1:20))
LM <- function(
X = NA,
R = 1,
C = 1,
B = T,
W = 1,
H = 1,
DN = NULL){
if (is.object(X) || !is.atomic(X))
X <- as.vector(X)
X <- as.character(X)
M <- base::.Internal(matrix(X, R, C, B, DN, missing(R),missing(C)))
attr(M,"W") <- W
attr(M,"H") <- H
return(M)
}
A <- LM( X=1:4 , C=2 , W=c(0.2,.35) , H=c(.5,2) )
A
A <- LM( X=1:4 , C=2 , W=c(0.2,.35) , H=c(.5,2) )
A
B <- LM( X=c(1,"A",10,11) , C=2 , W=c(.5,1) , H=c(1,1) )
B
B
dim(A)
dim(B)
mypar <- function(){
par(
mar = c(3,3,2,2),
mgp = c(1.5, 0.3, 0),
tcl = c(-0.2),
las = 1,
font.main = 1,
pch = 16)
}
x <- c( 0.2, 0.35, 0.7)
sum(x)
x <- x / sum(x)
x*100
plot.function()
mypar()
plot(11:20,1:10,main="lfjasflajs",frame=F)
par("plt")
hist(rnorm(30))
LM <- function(
X = NA,
R = 1,
C = 1,
B = T,
W = 1,
H = 1,
DN = NULL){
if (is.object(X) || !is.atomic(X))
X <- as.vector(X)
X <- as.character(X)
M <- base::.Internal(matrix(X, R, C, B, DN, missing(R),missing(C)))
attr(M,"W") <- W
attr(M,"H") <- H
return(M)
}
A <- LM( X=1:4 , C=2 , W=c(0.2,.35) , H=c(.5,2) )
A
B <- LM( X=c(1,"A",10,11) , C=2 , W=c(.5,1) , H=c(1,1) )
B
B
B
